{% comment %}
  Individual blog article template for Kala Aabharanam
  Displays full article content with social sharing and related articles
{% endcomment %}

<article class="article-page">
  <div class="container">
    <!-- Article Header -->
    <header class="article-header">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol class="breadcrumb__list">
          <li class="breadcrumb__item">
            <a href="{{ routes.root_url }}" class="breadcrumb__link">Home</a>
          </li>
          <li class="breadcrumb__item">
            <a href="{{ blog.url }}" class="breadcrumb__link">{{ blog.title }}</a>
          </li>
          <li class="breadcrumb__item breadcrumb__item--current" aria-current="page">
            {{ article.title }}
          </li>
        </ol>
      </nav>

      <div class="article-meta">
        <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}" 
              class="article-meta__date">
          {{ article.published_at | date: '%B %d, %Y' }}
        </time>
        <span class="article-meta__author">
          By {{ article.author | default: shop.name }}
        </span>
        {% if article.tags.size > 0 %}
          <div class="article-meta__tags">
            {% for tag in article.tags %}
              <a href="{{ blog.url }}/tagged/{{ tag | handle }}" 
                 class="article-meta__tag">
                {{ tag }}
              </a>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <h1 class="article-title">{{ article.title }}</h1>

      {% if article.excerpt != blank %}
        <div class="article-excerpt">
          {{ article.excerpt }}
        </div>
      {% endif %}
    </header>

    <!-- Featured Image -->
    {% if article.image %}
      <div class="article-featured-image">
        <img src="{{ article.image | image_url: width: 1200 }}"
             alt="{{ article.image.alt | default: article.title }}"
             class="article-featured-image__img">
      </div>
    {% endif %}

    <!-- Article Content -->
    <div class="article-content-wrapper">
      <div class="article-content">
        {{ article.content }}
      </div>

      <!-- Social Sharing -->
      <div class="article-sharing">
        <h3 class="article-sharing__title">Share this article</h3>
        <div class="article-sharing__buttons">
          <a href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url }}{{ article.url }}"
             target="_blank"
             rel="noopener"
             class="article-sharing__button article-sharing__button--facebook"
             aria-label="Share on Facebook">
            {% render 'icon', icon: 'facebook' %}
            Facebook
          </a>
          <a href="https://twitter.com/intent/tweet?url={{ shop.url }}{{ article.url }}&text={{ article.title | url_encode }}"
             target="_blank"
             rel="noopener"
             class="article-sharing__button article-sharing__button--twitter"
             aria-label="Share on Twitter">
            {% render 'icon', icon: 'twitter' %}
            Twitter
          </a>
          <a href="https://www.pinterest.com/pin/create/button/?url={{ shop.url }}{{ article.url }}&media={{ article.image | image_url: width: 600 }}&description={{ article.title | url_encode }}"
             target="_blank"
             rel="noopener"
             class="article-sharing__button article-sharing__button--pinterest"
             aria-label="Share on Pinterest">
            {% render 'icon', icon: 'pinterest' %}
            Pinterest
          </a>
          <button onclick="navigator.share ? navigator.share({title: '{{ article.title | escape }}', url: '{{ shop.url }}{{ article.url }}'}) : copyToClipboard('{{ shop.url }}{{ article.url }}')"
                  class="article-sharing__button article-sharing__button--copy"
                  aria-label="Copy link">
            {% render 'icon', icon: 'link' %}
            Copy Link
          </button>
        </div>
      </div>
    </div>

    <!-- Related Articles -->
    {% assign related_articles = blog.articles | where: 'id', '!=', article.id %}
    {% if related_articles.size > 0 %}
      <section class="related-articles">
        <h2 class="related-articles__title">Related Articles</h2>
        <div class="related-articles__grid">
          {% for related_article in related_articles limit: 3 %}
            <article class="related-article-card">
              {% if related_article.image %}
                <div class="related-article-card__image">
                  <a href="{{ related_article.url }}">
                    <img src="{{ related_article.image | image_url: width: 300 }}"
                         alt="{{ related_article.image.alt | default: related_article.title }}"
                         loading="lazy"
                         class="related-article-card__img">
                  </a>
                </div>
              {% endif %}
              <div class="related-article-card__content">
                <h3 class="related-article-card__title">
                  <a href="{{ related_article.url }}" class="related-article-card__title-link">
                    {{ related_article.title }}
                  </a>
                </h3>
                <time datetime="{{ related_article.published_at | date: '%Y-%m-%d' }}" 
                      class="related-article-card__date">
                  {{ related_article.published_at | date: '%B %d, %Y' }}
                </time>
              </div>
            </article>
          {% endfor %}
        </div>
      </section>
    {% endif %}

    <!-- Navigation -->
    <nav class="article-navigation" aria-label="Article navigation">
      {% if blog.previous_article %}
        <a href="{{ blog.previous_article.url }}" class="article-nav-link article-nav-link--prev">
          {% render 'icon', icon: 'arrow-left' %}
          <div class="article-nav-link__content">
            <span class="article-nav-link__label">Previous Article</span>
            <span class="article-nav-link__title">{{ blog.previous_article.title }}</span>
          </div>
        </a>
      {% endif %}

      <a href="{{ blog.url }}" class="article-nav-link article-nav-link--blog">
        All Articles
      </a>

      {% if blog.next_article %}
        <a href="{{ blog.next_article.url }}" class="article-nav-link article-nav-link--next">
          <div class="article-nav-link__content">
            <span class="article-nav-link__label">Next Article</span>
            <span class="article-nav-link__title">{{ blog.next_article.title }}</span>
          </div>
          {% render 'icon', icon: 'arrow-right' %}
        </a>
      {% endif %}
    </nav>
  </div>
</article>

<script>
  function copyToClipboard(text) {
    if (navigator.clipboard) {
      navigator.clipboard.writeText(text).then(() => {
        alert('Link copied to clipboard!');
      });
    } else {
      // Fallback for older browsers
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
      alert('Link copied to clipboard!');
    }
  }
</script>

<style>
  .article-page {
    padding: 2rem 0;
  }

  .breadcrumb {
    margin-bottom: 2rem;
  }

  .breadcrumb__list {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 0.9rem;
  }

  .breadcrumb__item:not(:last-child)::after {
    content: 'â€º';
    margin-left: 0.5rem;
    color: var(--color-text);
  }

  .breadcrumb__link {
    color: var(--color-primary);
    text-decoration: none;
  }

  .breadcrumb__link:hover {
    text-decoration: underline;
  }

  .breadcrumb__item--current {
    color: var(--color-text);
  }

  .article-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .article-meta {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    font-size: 0.9rem;
    color: var(--color-text);
  }

  .article-meta__tags {
    display: flex;
    gap: 0.5rem;
  }

  .article-meta__tag {
    background-color: var(--color-background);
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    color: var(--color-primary);
    text-decoration: none;
    font-size: 0.8rem;
    transition: background-color 0.3s ease;
  }

  .article-meta__tag:hover {
    background-color: var(--color-secondary);
  }

  .article-title {
    font-family: var(--font-heading);
    font-size: 2.5rem;
    color: var(--color-primary);
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  .article-excerpt {
    font-size: 1.2rem;
    color: var(--color-text);
    font-style: italic;
    max-width: 800px;
    margin: 0 auto;
  }

  .article-featured-image {
    margin-bottom: 3rem;
    border-radius: 8px;
    overflow: hidden;
  }

  .article-featured-image__img {
    width: 100%;
    height: auto;
    display: block;
  }

  .article-content-wrapper {
    max-width: 800px;
    margin: 0 auto;
  }

  .article-content {
    font-size: 1.1rem;
    line-height: 1.8;
    color: var(--color-text);
    margin-bottom: 3rem;
  }

  .article-content h2,
  .article-content h3,
  .article-content h4 {
    font-family: var(--font-heading);
    color: var(--color-primary);
    margin: 2rem 0 1rem;
  }

  .article-content p {
    margin-bottom: 1.5rem;
  }

  .article-content img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 2rem 0;
  }

  .article-sharing {
    padding: 2rem 0;
    border-top: 1px solid var(--color-background);
    border-bottom: 1px solid var(--color-background);
    margin-bottom: 3rem;
  }

  .article-sharing__title {
    font-family: var(--font-heading);
    color: var(--color-primary);
    margin-bottom: 1rem;
    text-align: center;
  }

  .article-sharing__buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .article-sharing__button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border: 1px solid var(--color-secondary);
    border-radius: 25px;
    text-decoration: none;
    color: var(--color-text);
    background: white;
    transition: all 0.3s ease;
    cursor: pointer;
    font-size: 0.9rem;
  }

  .article-sharing__button:hover {
    background-color: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
  }

  .related-articles {
    margin-bottom: 3rem;
  }

  .related-articles__title {
    font-family: var(--font-heading);
    font-size: 2rem;
    color: var(--color-primary);
    text-align: center;
    margin-bottom: 2rem;
  }

  .related-articles__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }

  .related-article-card {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
  }

  .related-article-card:hover {
    transform: translateY(-3px);
  }

  .related-article-card__image {
    aspect-ratio: 16/9;
    overflow: hidden;
  }

  .related-article-card__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .related-article-card__content {
    padding: 1rem;
  }

  .related-article-card__title-link {
    font-family: var(--font-heading);
    color: var(--color-primary);
    text-decoration: none;
    font-size: 1.1rem;
    line-height: 1.3;
  }

  .related-article-card__title-link:hover {
    color: var(--color-accent);
  }

  .related-article-card__date {
    font-size: 0.9rem;
    color: var(--color-text);
    margin-top: 0.5rem;
    display: block;
  }

  .article-navigation {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 1rem;
    align-items: center;
  }

  .article-nav-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    border: 1px solid var(--color-secondary);
    border-radius: 8px;
    text-decoration: none;
    color: var(--color-text);
    transition: all 0.3s ease;
  }

  .article-nav-link:hover {
    background-color: var(--color-background);
    border-color: var(--color-primary);
  }

  .article-nav-link--prev {
    justify-self: start;
  }

  .article-nav-link--next {
    justify-self: end;
  }

  .article-nav-link--blog {
    justify-self: center;
    background-color: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
  }

  .article-nav-link--blog:hover {
    background-color: var(--color-accent);
  }

  .article-nav-link__content {
    display: flex;
    flex-direction: column;
  }

  .article-nav-link__label {
    font-size: 0.8rem;
    opacity: 0.8;
  }

  .article-nav-link__title {
    font-weight: 500;
  }

  @media (max-width: 768px) {
    .article-title {
      font-size: 2rem;
    }

    .article-meta {
      flex-direction: column;
      gap: 0.5rem;
    }

    .article-sharing__buttons {
      flex-direction: column;
      align-items: center;
    }

    .article-navigation {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .article-nav-link {
      justify-self: stretch !important;
    }

    .related-articles__grid {
      grid-template-columns: 1fr;
    }
  }
</style>